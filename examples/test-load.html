<!DOCTYPE html>
<html>
<head>
    <title>SyncKit Module Load Test</title>
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom": "https://esm.sh/react-dom@18.2.0",
            "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime"
        }
    }
    </script>
</head>
<body>
    <h1>Testing SyncKit Module Loading</h1>
    <div id="status">Initializing...</div>
    <div id="error" style="color: red;"></div>

    <script type="module">
        const statusEl = document.getElementById('status')
        const errorEl = document.getElementById('error')

        try {
            statusEl.textContent = 'Step 1: Importing SyncKit...'
            console.log('Step 1: Importing SyncKit...')

            const { SyncKit } = await import('../sdk/dist/index.mjs')

            statusEl.textContent = 'Step 2: SyncKit imported successfully!'
            console.log('Step 2: SyncKit imported!', SyncKit)

            statusEl.textContent = 'Step 3: Creating SyncKit instance...'
            console.log('Step 3: Creating SyncKit instance...')

            const synckit = new SyncKit({
                serverUrl: 'ws://127.0.0.1:8080/ws'
            })

            statusEl.textContent = 'Step 4: Initializing SyncKit...'
            console.log('Step 4: Initializing SyncKit...')

            await synckit.init()

            statusEl.textContent = 'Step 5: SyncKit initialized successfully!'
            console.log('Step 5: SyncKit initialized!', synckit)

            statusEl.textContent = 'SUCCESS! SyncKit is working. Check console for details.'
            statusEl.style.color = 'green'

        } catch (error) {
            console.error('ERROR:', error)
            errorEl.textContent = `Error: ${error.message}\n\nStack: ${error.stack}`
            statusEl.textContent = 'FAILED - See error above and check browser console'
            statusEl.style.color = 'red'
        }
    </script>
</body>
</html>
